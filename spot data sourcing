import yfinance as yf
import pandas as pd

# List of index tickers
index_tickers = [
    "^FCHI",  # CAC 40
    "FTSEMIB.MI",  # FTSE MIB
    "^GSPC",  # S&P 500
    "^FTSE",  # FTSE 100
    "^SSMI",  # Swiss Market Index (SMI)
    "^HSCE",  # Hang Seng China Enterprises Index
    "^N225",  # Nikkei 225
    "^RUT",  # Russell 2000
    "IWDA.L",  # MSCI World Index
    "EEM",  # MSCI Emerging Markets Index
    "^DJI",  # Dow Jones Industrial Average
    "^GDAXI",  # DAX
]

# Download data for multiple tickers from 01-01-2010 onwards
data = yf.download(index_tickers, start="2010-01-01", group_by='ticker')

all_data = []
# Loop through each ticker and clean its data
for ticker in index_tickers:
    df = data[ticker].reset_index()
    df['Ticker'] = ticker
    all_data.append(df)

# Concatenate all DataFrames into one large DataFrame
final_data = pd.concat(all_data, ignore_index=True)

# Save the combined data into a CSV file
final_data.to_csv("combined_spot_index_data.csv", index=False)

print("Download and saving to CSV complete.")
